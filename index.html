<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>Test Coverage versus Commit</title>
    <script src="https://d3js.org/d3.v4.min.js" charset="utf-8"></script>
    <style type="text/css">
    </style>
</head>

<body>
    <script type="text/javascript">

        // Could refactor this to make it more programmatic
        // 1. Set Margins: Recommended by one of the creators of D3 - https://bl.ocks.org/mbostock/3019563
        var margin = { top: 20, right: 10, bottom: 20, left: 10 };

        // 2. Create SVG - Scalable Vector Graphics
        // NOTE: Can add more svgs for multiple graphs displayed
        var width = 1000
            height = 500

        var stackedBarChartSVG = d3.select("body").append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

        // 3. Set axis scales for x and y - https://www.dashingd3js.com/d3js-axes
        var xScale = d3.scaleBand().rangeRound([0, width])
        var yScale = d3.scaleLinear().rangeRound([height, 0]);
        var xAxis = d3.axisBottom(xScale);
        var yAxis = d3.axisLeft(yScale);

        // 4. Set colours of the bars
        var colours = ["#1f77b4", "#aec7e8", "#ff7f0e", "#ffbb78"];
        var z = d3.scaleOrdinal()
            .range(colours);

        // 5. Load Data: https://d3-wiki.readthedocs.io/zh_CN/master/CSV/
        d3.csv("viz-test-data/CoverageStackedBarChart.csv", function (d) {
            return {
                commit: +d.Commit,
                branch: +d["Branch Coverage %"],
                statement: +d["Statement Coverage %"],
                line: +d["Line Coverage %"]
            };
        }, function (error, rows) {
            console.log(rows);
            // Do the rest of the chart rendering here

            // 6. Render the x and y axis.
            stackedBarChartSVG.append("g")
                .attr("class", "x axis")
                .attr("transform", "translate(0," + height + ")")
                .call(xAxis);

            stackedBarChartSVG.append("g")
                .attr("class", "y axis")
                .call(yAxis); 
        });

    </script>
</body>

</html>